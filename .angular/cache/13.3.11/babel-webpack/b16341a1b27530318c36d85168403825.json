{"ast":null,"code":"import { AppsessionService } from '../service/appsession.service';\nimport { NotificationService } from './service/notification.service';\nimport { PSNotificationType } from '../common/AppConstants';\nimport { SwPush } from '@angular/service-worker';\nimport { environment } from '../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../service/appsession.service\";\nimport * as i2 from \"./service/notification.service\";\nimport * as i3 from \"@angular/service-worker\";\nimport * as i4 from \"./list/notificationlist.component\";\nimport * as i5 from \"@ngx-translate/core\";\nexport let NotificationComponent = /*#__PURE__*/(() => {\n  class NotificationComponent {\n    constructor(appsession, notifyService, swPush) {\n      this.appsession = appsession;\n      this.notifyService = notifyService;\n      this.swPush = swPush;\n      this.currentData = new Array();\n      this.titleKey = \"Notification\";\n      this.isDataFetched = false;\n      this.allCount = 0;\n      this.srCount = 0;\n      this.cmCount = 0;\n      this.rvCount = 0;\n      this.resCount = 0;\n    }\n\n    ngOnInit() {\n      this.subscription = this.notifyService.notifyListChange.subscribe(data => {\n        if (data != null) {\n          this.availableData = data.notificationVMS;\n          this.allCount = data.nonViewedCount;\n          this.srCount = this.availableData.filter(x => x.notificationTypeEnum == PSNotificationType[PSNotificationType.ServiceRequest] && x.addedDateUtc > data.lastViewDateUTC).length;\n          this.cmCount = this.availableData.filter(x => x.notificationTypeEnum == PSNotificationType[PSNotificationType.CommentCard] && x.addedDateUtc > data.lastViewDateUTC).length;\n          this.rvCount = this.availableData.filter(x => x.notificationTypeEnum == PSNotificationType[PSNotificationType.Review] && x.addedDateUtc > data.lastViewDateUTC).length;\n          this.resCount = this.availableData.filter(x => x.notificationTypeEnum == PSNotificationType[PSNotificationType.Residents] && x.addedDateUtc > data.lastViewDateUTC).length;\n        }\n      });\n      this.appsession.SetAppTitle(this.titleKey);\n    }\n\n    enablePushNotification() {\n      this.swPush.requestSubscription({\n        serverPublicKey: environment.pushPublickKey\n      }).then(sub => {\n        console.log(sub);\n        let defaultOptions = {\n          title: this.appsession.getTranslated(\"CommiHub\"),\n          body: this.appsession.getTranslated(\"PushNoficationEnabled\"),\n          icon: \"/assets/images/sitelogo/android-icon-96x96.png\",\n          vibrate: [100, 50, 100]\n        };\n        new Notification(this.appsession.getTranslated(\"CommiHub\"), defaultOptions);\n      }).catch(err => {});\n    }\n\n    filerByType(typeValue) {\n      if (typeValue == 'All') {\n        this.notifyService.filteredNotifyListChange.next(this.availableData);\n        return;\n      }\n\n      this.currentData = this.availableData.filter(x => x.notificationTypeEnum == typeValue);\n      this.notifyService.filteredNotifyListChange.next(this.currentData);\n    }\n\n    ngOnDestroy() {\n      this.appsession.currentUnviewdNotificationCountChange.next(0);\n      this.subscription.unsubscribe();\n    }\n\n  }\n\n  NotificationComponent.ɵfac = function NotificationComponent_Factory(t) {\n    return new (t || NotificationComponent)(i0.ɵɵdirectiveInject(i1.AppsessionService), i0.ɵɵdirectiveInject(i2.NotificationService), i0.ɵɵdirectiveInject(i3.SwPush));\n  };\n\n  NotificationComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: NotificationComponent,\n    selectors: [[\"app-notification\"]],\n    decls: 45,\n    vars: 32,\n    consts: [[1, \"container\"], [1, \"row\"], [1, \"col-xl-3\", \"col-lg-3\", \"col-md-12\", \"col-sm-12\", \"col-xs-12\"], [1, \"ui-block\"], [1, \"your-profile\"], [1, \"ui-block-title\"], [1, \"h6\", \"title\", 2, \"cursor\", \"pointer\", 3, \"click\"], [1, \"items-round-little\", \"bg-primary\", 3, \"hidden\"], [1, \"items-round-little\", \"bg-blue\", 3, \"hidden\"], [1, \"col-xl-9\", \"col-lg-9\", \"col-md-12\", \"col-sm-12\", \"col-xs-12\"], [1, \"title\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [3, \"isMainPage\"]],\n    template: function NotificationComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"a\", 6);\n        i0.ɵɵlistener(\"click\", function NotificationComponent_Template_a_click_6_listener() {\n          return ctx.filerByType(\"All\");\n        });\n        i0.ɵɵtext(7);\n        i0.ɵɵpipe(8, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(9, \"i\", 7);\n        i0.ɵɵtext(10);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"div\", 5)(12, \"a\", 6);\n        i0.ɵɵlistener(\"click\", function NotificationComponent_Template_a_click_12_listener() {\n          return ctx.filerByType(\"ServiceRequest\");\n        });\n        i0.ɵɵtext(13);\n        i0.ɵɵpipe(14, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"i\", 8);\n        i0.ɵɵtext(16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"div\", 5)(18, \"a\", 6);\n        i0.ɵɵlistener(\"click\", function NotificationComponent_Template_a_click_18_listener() {\n          return ctx.filerByType(\"Residents\");\n        });\n        i0.ɵɵtext(19);\n        i0.ɵɵpipe(20, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"i\", 8);\n        i0.ɵɵtext(22);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(23, \"div\", 5)(24, \"i\", 6);\n        i0.ɵɵlistener(\"click\", function NotificationComponent_Template_i_click_24_listener() {\n          return ctx.filerByType(\"Review\");\n        });\n        i0.ɵɵtext(25);\n        i0.ɵɵpipe(26, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"i\", 8);\n        i0.ɵɵtext(28);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(29, \"div\", 5)(30, \"a\", 6);\n        i0.ɵɵlistener(\"click\", function NotificationComponent_Template_a_click_30_listener() {\n          return ctx.filerByType(\"CommentCard\");\n        });\n        i0.ɵɵtext(31);\n        i0.ɵɵpipe(32, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(33, \"i\", 8);\n        i0.ɵɵtext(34);\n        i0.ɵɵelementEnd()()()()();\n        i0.ɵɵelementStart(35, \"div\", 9)(36, \"div\", 3)(37, \"div\", 5)(38, \"h6\", 10);\n        i0.ɵɵtext(39);\n        i0.ɵɵpipe(40, \"translate\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"button\", 11);\n        i0.ɵɵlistener(\"click\", function NotificationComponent_Template_button_click_41_listener() {\n          return ctx.enablePushNotification();\n        });\n        i0.ɵɵtext(42);\n        i0.ɵɵpipe(43, \"translate\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelement(44, \"app-notificationlist\", 12);\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(8, 18, \"General\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", ctx.allCount < 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.allCount);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(14, 20, \"ServiceRequests\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", ctx.srCount < 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.srCount);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(20, 22, \"Residents\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", ctx.resCount < 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.resCount);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(26, 24, \"Reviews\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", ctx.rvCount < 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.rvCount);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(32, 26, \"CommentCard\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"hidden\", ctx.cmCount < 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.cmCount);\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(40, 28, \"Notifications\"));\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(43, 30, \"EnablePushNotification\"));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"isMainPage\", true);\n      }\n    },\n    directives: [i4.NotificationlistComponent],\n    pipes: [i5.TranslatePipe],\n    encapsulation: 2\n  });\n  return NotificationComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}