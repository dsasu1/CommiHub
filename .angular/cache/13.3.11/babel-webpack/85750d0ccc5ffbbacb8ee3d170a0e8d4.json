{"ast":null,"code":"import { AppsessionService } from '../../service/appsession.service';\nimport { PropertyInformation } from '../model/property.model';\nimport { PropertyService } from '../service/property.service';\nimport { UserTypeEnum } from '../../common/AppConstants';\nimport { MessageDetail } from '../../model/utility.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../service/appsession.service\";\nimport * as i2 from \"../service/property.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"../../common/directives/sweetalert.directive\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"../../sharedcomponents/paging/pager.component\";\nimport * as i7 from \"@ngx-translate/core\";\n\nfunction PropertylistsComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 4)(1, \"h5\");\n    i0.ɵɵtext(2);\n    i0.ɵɵpipe(3, \"translate\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(3, 1, \"NoPropertiestodisplay\"));\n  }\n}\n\nfunction PropertylistsComponent_div_2_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵelement(1, \"i\", 23);\n    i0.ɵɵelementStart(2, \"ul\", 24)(3, \"li\")(4, \"a\", 25);\n    i0.ɵɵlistener(\"onConfirm\", function PropertylistsComponent_div_2_div_6_Template_a_onConfirm_4_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const i_r4 = i0.ɵɵnextContext().index;\n      const ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.ondeleteProperty(i_r4);\n    });\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"translate\");\n    i0.ɵɵelementEnd()()()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(6, 1, \"Delete\"));\n  }\n}\n\nconst _c0 = function (a1) {\n  return [\"/manageproperty\", a1];\n};\n\nfunction PropertylistsComponent_div_2_a_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const prop_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(4, _c0, prop_r3.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 2, \"Manage\"), \" \");\n  }\n}\n\nconst _c1 = function (a1) {\n  return [\"/managehome\", a1];\n};\n\nfunction PropertylistsComponent_div_2_a_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"translate\");\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const prop_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(4, _c1, prop_r3.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(2, 2, \"Manage\"), \" \");\n  }\n}\n\nfunction PropertylistsComponent_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 5)(1, \"div\", 6)(2, \"div\", 7)(3, \"div\", 8);\n    i0.ɵɵelement(4, \"img\", 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 10);\n    i0.ɵɵtemplate(6, PropertylistsComponent_div_2_div_6_Template, 7, 3, \"div\", 11);\n    i0.ɵɵelementStart(7, \"div\", 12)(8, \"div\", 13)(9, \"div\", 14);\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(11, \"div\", 15)(12, \"h5\", 16);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"div\", 14);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"div\", 14)(17, \"h3\")(18, \"kbd\");\n    i0.ɵɵtext(19);\n    i0.ɵɵelementEnd()()()()();\n    i0.ɵɵelementStart(20, \"div\", 17)(21, \"div\", 18)(22, \"div\", 19)(23, \"div\", 20);\n    i0.ɵɵtemplate(24, PropertylistsComponent_div_2_a_24_Template, 3, 6, \"a\", 21);\n    i0.ɵɵtemplate(25, PropertylistsComponent_div_2_a_25_Template, 3, 6, \"a\", 21);\n    i0.ɵɵelementEnd()()()()()()()();\n  }\n\n  if (rf & 2) {\n    const prop_r3 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", ctx_r1.GetImageUrl(prop_r3), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.userSession.isManager && !ctx_r1.isTenant);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(prop_r3.propType);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(prop_r3.propName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate3(\"\", prop_r3.zipCode.city, \", \", prop_r3.zipCode.province, \" \", prop_r3.zipCode.countryCode, \"\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(prop_r3.propCode);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.isTenant);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.isTenant);\n  }\n}\n\nfunction PropertylistsComponent_app_pager_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"app-pager\", 27);\n    i0.ɵɵlistener(\"onPaged\", function PropertylistsComponent_app_pager_3_Template_app_pager_onPaged_0_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.currentdata = $event;\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"dataList\", ctx_r2.availabledata);\n  }\n}\n\nexport let PropertylistsComponent = /*#__PURE__*/(() => {\n  class PropertylistsComponent {\n    constructor(appsession, propSource) {\n      this.appsession = appsession;\n      this.propSource = propSource;\n      this.currentdata = new Array();\n      this.isTenant = false;\n    }\n\n    trackingBy(index, data) {\n      return data.id;\n    }\n\n    ngOnInit() {\n      this.subscription = this.propSource.propInfoListChange.subscribe(value => {\n        this.propInfos = Object.assign([], value);\n\n        if (this.roleId == null) {\n          this.availabledata = this.propInfos;\n\n          if (this.availabledata != null) {\n            this.currentdata = this.appsession.paginate(this.availabledata, this.appsession.defaultPageSize, this.appsession.defaultPageSize);\n          }\n        } else {\n          this.propSource.loadPropertyAccess(this.appsession.CurrentUser.userVM.id, this.roleId);\n        }\n      });\n\n      if (this.roleId != null) {\n        this.subscriptionTwo = this.propSource.propAccessListChange.subscribe(value => {\n          if (this.propInfos != null) {\n            if (value != null) {\n              let tempProps = [];\n\n              for (let i = 0; i < value.length; i++) {\n                let filtered = this.propInfos.find(x => x.id == value[i].propertyInformationId);\n\n                if (filtered != null) {\n                  tempProps.push(filtered);\n                }\n              }\n\n              this.availabledata = tempProps;\n\n              if (this.availabledata != null) {\n                this.currentdata = this.appsession.paginate(this.availabledata, this.appsession.defaultPageSize, this.appsession.defaultPageSize);\n              }\n            }\n          }\n        });\n      }\n\n      if (this.appsession.IsUserLoggedIn) {\n        this.isTenant = this.appsession.CurrentUser.userTypeEnum == UserTypeEnum[UserTypeEnum.Tenant];\n        this.userSession = this.appsession.CurrentUser;\n\n        if (this.propSource.propInfoList != null && this.propSource.propInfoList.length > 0) {\n          this.propSource.propInfoListChange.next(this.propSource.propInfoList);\n        } else if (this.appsession.properties != null && this.appsession.properties.length > 0) {\n          this.propSource.propInfoListChange.next(this.appsession.properties);\n        } else {\n          this.propSource.loadUserProperties(this.appsession.CurrentUser.userVM.id);\n        }\n      }\n    }\n\n    GetImageUrl(prop) {\n      let result = this.appsession.getImageData(prop.coverThumbnail, 'image', '../../../assets/img/top-header1.jpg');\n      return result;\n    }\n\n    ondeleteProperty(index) {\n      if (this.currentdata[index].isDemoAccount) {\n        let message = new MessageDetail();\n        message.isInfo = true;\n        message.msg = this.appsession.getTranslated(\"DemoFunctionalityLimited\");\n        this.appsession.setGlobalHeaderMessage(message);\n        return;\n      }\n\n      if (this.roleId != null) {\n        this.propSource.deletePropertyAccess(this.appsession.CurrentUser.userVM.id, this.currentdata[index].id, this.roleId).subscribe(data => {\n          if (data) {\n            this.propSource.loadUserProperties(this.appsession.CurrentUser.userVM.id);\n          }\n        });\n      } else {\n        this.propSource.deleteProperty(this.appsession.CurrentUser.userVM.id, this.currentdata[index].id).subscribe(data => {\n          if (data) {\n            this.propSource.loadUserProperties(this.appsession.CurrentUser.userVM.id);\n          }\n        }, error => {\n          let message = new MessageDetail();\n          message.isSuccess = false;\n          message.msg = this.appsession.getHttpErrorMessages(error)[0];\n          this.appsession.setGlobalHeaderMessage(message);\n        });\n      }\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n\n      if (this.roleId != null) {\n        this.subscriptionTwo.unsubscribe();\n      }\n    }\n\n  }\n\n  PropertylistsComponent.ɵfac = function PropertylistsComponent_Factory(t) {\n    return new (t || PropertylistsComponent)(i0.ɵɵdirectiveInject(i1.AppsessionService), i0.ɵɵdirectiveInject(i2.PropertyService));\n  };\n\n  PropertylistsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PropertylistsComponent,\n    selectors: [[\"app-propertylists\"]],\n    inputs: {\n      roleId: \"roleId\"\n    },\n    decls: 4,\n    vars: 4,\n    consts: [[\"class\", \"ui-block text-center\", 4, \"ngIf\"], [1, \"row\"], [\"class\", \"col-xl-4 col-lg-6 col-md-6 col-sm-6 col-xs-6\", 4, \"ngFor\", \"ngForOf\", \"ngForTrackBy\"], [3, \"dataList\", \"onPaged\", 4, \"ngIf\"], [1, \"ui-block\", \"text-center\"], [1, \"col-xl-4\", \"col-lg-6\", \"col-md-6\", \"col-sm-6\", \"col-xs-6\"], [1, \"ui-block\"], [1, \"friend-item\"], [1, \"friend-header-thumb\"], [\"alt\", \"friend\", 3, \"src\"], [1, \"friend-item-content\"], [\"class\", \"more\", 4, \"ngIf\"], [1, \"friend-avatar\"], [1, \"author-thumb\"], [1, \"country\"], [1, \"author-content\"], [1, \"author-name\"], [\"data-slide\", \"fade\", 1, \"swiper-container\"], [1, \"swiper-wrapper\"], [1, \"swiper-slide\"], [1, \"control-block-button\"], [\"class\", \"btn bg-blue\", 3, \"routerLink\", 4, \"ngIf\"], [1, \"more\"], [1, \"fa\", \"fa-ellipsis-h\"], [1, \"more-dropdown\"], [\"PSSweetAlert\", \"\", 2, \"cursor\", \"pointer\", 3, \"onConfirm\"], [1, \"btn\", \"bg-blue\", 3, \"routerLink\"], [3, \"dataList\", \"onPaged\"]],\n    template: function PropertylistsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, PropertylistsComponent_div_0_Template, 4, 3, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵtemplate(2, PropertylistsComponent_div_2_Template, 26, 10, \"div\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(3, PropertylistsComponent_app_pager_3_Template, 1, 1, \"app-pager\", 3);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.currentdata.length < 1);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.currentdata)(\"ngForTrackBy\", ctx.trackingBy);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.availabledata);\n      }\n    },\n    directives: [i3.NgIf, i3.NgForOf, i4.PSSweetAlertDirective, i5.RouterLinkWithHref, i6.PagerComponent],\n    pipes: [i7.TranslatePipe],\n    encapsulation: 2\n  });\n  return PropertylistsComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}